<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build a SOM for quality analysis of time series samples — sits_som_map • sits</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Serif-0.4.10/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a SOM for quality analysis of time series samples — sits_som_map"><meta name="description" content="These function use self-organized maps to perform
quality analysis in satellite image time series."><meta property="og:description" content="These function use self-organized maps to perform
quality analysis in satellite image time series."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.3-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://e-sensing.github.io/sitsbook/">Book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/e-sensing/sits/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build a SOM for quality analysis of time series samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/e-sensing/sits/blob/master/R/sits_som.R" class="external-link"><code>R/sits_som.R</code></a></small>
      <div class="d-none name"><code>sits_som_map.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These function use self-organized maps to perform
quality analysis in satellite image time series.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sits_som_map</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  grid_xdim <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  grid_ydim <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rlen <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"dtw"</span>,</span>
<span>  som_radius <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"online"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tibble with samples to be clustered.</p></dd>


<dt id="arg-grid-xdim">grid_xdim<a class="anchor" aria-label="anchor" href="#arg-grid-xdim"></a></dt>
<dd><p>X dimension of the SOM grid (default = 25).</p></dd>


<dt id="arg-grid-ydim">grid_ydim<a class="anchor" aria-label="anchor" href="#arg-grid-ydim"></a></dt>
<dd><p>Y dimension of the SOM grid.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Starting learning rate
(decreases according to number of iterations).</p></dd>


<dt id="arg-rlen">rlen<a class="anchor" aria-label="anchor" href="#arg-rlen"></a></dt>
<dd><p>Number of iterations to produce the SOM.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>The type of similarity measure (distance). The
following similarity measurements are supported:
<code>"euclidean"</code> and <code>"dtw"</code>. The default
similarity measure is <code>"dtw"</code>.</p></dd>


<dt id="arg-som-radius">som_radius<a class="anchor" aria-label="anchor" href="#arg-som-radius"></a></dt>
<dd><p>Radius of SOM neighborhood.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Type of learning algorithm. The
following learning algorithm are available:
<code>"online"</code>, <code>"batch"</code>, and <code>"pbatch"</code>.
The default learning algorithm is <code>"online"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>sits_som_map()</code> produces a list with three members:
(1) the samples tibble, with one additional column indicating
to which neuron each sample has been mapped;
(2) the Kohonen map, used for plotting and cluster quality measures;
(3) a tibble with the labelled neurons,
where each class of each neuron is associated to two values:
(a) the prior probability that this class belongs to a cluster
based on the frequency of samples of this class allocated to the neuron;
(b) the posterior probability that this class belongs to a cluster,
using data for the neighbours on the SOM map.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p><code>sits_som_map</code> creates a SOM map, where
high-dimensional data is mapped into a two dimensional map,
keeping the topological relations
between data patterns. Each sample is assigned to a neuron,
and neurons are placed in the grid based on similarity.</p>
<p><code><a href="sits_som_evaluate_cluster.html">sits_som_evaluate_cluster</a></code> analyses the neurons of
the SOM map, and builds clusters based on them. Each cluster is a neuron
or a set of neuron categorized with same label.
It produces a tibble with the percentage of mixture of classes
in each cluster.</p>
<p><code><a href="sits_som_clean_samples.html">sits_som_clean_samples</a></code> evaluates sample quality
based on the results of the SOM map.  The algorithm identifies noisy samples,
using `prior_threshold` for the prior probability
and `posterior_threshold` for the posterior probability.
Each sample receives an evaluation tag, according to the following rule:
(a) If the prior probability is &lt; `prior_threshold`, the sample is tagged
as "remove";
(b) If the prior probability is &gt;= `prior_threshold` and the posterior
probability is &gt;=`posterior_threshold`, the sample is tagged as "clean";
(c) If the prior probability is &gt;= `posterior_threshold` and
the posterior probability is &lt; `posterior_threshold`, the sample is tagged as
"analyze" for further inspection.</p>
<p>The user can define which tagged samples will be returned using the "keep"
parameter, with the following options: "clean", "analyze", "remove".</p>
<p>To learn more about the learning algorithms, check the
      <code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html" class="external-link">kohonen::supersom</a></code> function.</p>
<p>The <code>sits</code> package implements the <code>"dtw"</code> (Dynamic Time
      Warping) similarity measure. The <code>"euclidean"</code> similarity
      measurement come from the
      <code><a href="https://rdrr.io/pkg/kohonen/man/supersom.html" class="external-link">kohonen::supersom (dist.fcts)</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lorena Santos, Karine Ferreira, Gilberto Camara, Michelle Picoli,
Rolf Simoes, “Quality control and class noise reduction of satellite
image time series”. ISPRS Journal of Photogrammetry and Remote Sensing,
vol. 177, pp 75-88, 2021. <a href="https://doi.org/10.1016/j.isprsjprs.2021.04.014" class="external-link">doi:10.1016/j.isprsjprs.2021.04.014</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lorena Alves, <a href="mailto:lorena.santos@inpe.br">lorena.santos@inpe.br</a></p>
<p>Karine Ferreira. <a href="mailto:karine.ferreira@inpe.br">karine.ferreira@inpe.br</a></p>
<p>Gilberto Camara, <a href="mailto:gilberto.camara@inpe.br">gilberto.camara@inpe.br</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="sits_run_examples.html">sits_run_examples</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># create a som map</span></span></span>
<span class="r-in"><span>    <span class="va">som_map</span> <span class="op">&lt;-</span> <span class="fu">sits_som_map</span><span class="op">(</span><span class="va">samples_modis_ndvi</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># plot the som map</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># evaluate the som map and create clusters</span></span></span>
<span class="r-in"><span>    <span class="va">clusters_som</span> <span class="op">&lt;-</span> <span class="fu"><a href="sits_som_evaluate_cluster.html">sits_som_evaluate_cluster</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># plot the cluster evaluation</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">clusters_som</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co"># clean the samples</span></span></span>
<span class="r-in"><span>    <span class="va">new_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="sits_som_clean_samples.html">sits_som_clean_samples</a></span><span class="op">(</span><span class="va">som_map</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rolf Simoes, Gilberto Camara, Felipe Souza, Felipe Carlos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

