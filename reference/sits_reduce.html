<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reduces a cube or samples from a summarization function — sits_reduce • sits</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Serif-0.4.10/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reduces a cube or samples from a summarization function — sits_reduce"><meta name="description" content="Apply a temporal reduction from a named expression in cube or sits tibble.
In the case of cubes, it materializes a new band in output_dir.
The result will be a cube with only one date with the raster reduced
from the function."><meta property="og:description" content="Apply a temporal reduction from a named expression in cube or sits tibble.
In the case of cubes, it materializes a new band in output_dir.
The result will be a cube with only one date with the raster reduced
from the function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.3-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://e-sensing.github.io/sitsbook/">Book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/e-sensing/sits/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reduces a cube or samples from a summarization function</h1>
      <small class="dont-index">Source: <a href="https://github.com/e-sensing/sits/blob/master/R/sits_reduce.R" class="external-link"><code>R/sits_reduce.R</code></a></small>
      <div class="d-none name"><code>sits_reduce.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Apply a temporal reduction from a named expression in cube or sits tibble.
In the case of cubes, it materializes a new band in <code>output_dir</code>.
The result will be a cube with only one date with the raster reduced
from the function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sits_reduce</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'sits'</span></span>
<span><span class="fu">sits_reduce</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'raster_cube'</span></span>
<span><span class="fu">sits_reduce</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  impute_fn <span class="op">=</span> <span class="fu"><a href="impute_linear.html">impute_linear</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  <span class="va">output_dir</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Valid sits tibble or cube</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Named expressions to be evaluated (see details).</p></dd>


<dt id="arg-impute-fn">impute_fn<a class="anchor" aria-label="anchor" href="#arg-impute-fn"></a></dt>
<dd><p>Imputation function to remove NA values.</p></dd>


<dt id="arg-memsize">memsize<a class="anchor" aria-label="anchor" href="#arg-memsize"></a></dt>
<dd><p>Memory available for classification (in GB).</p></dd>


<dt id="arg-multicores">multicores<a class="anchor" aria-label="anchor" href="#arg-multicores"></a></dt>
<dd><p>Number of cores to be used for classification.</p></dd>


<dt id="arg-output-dir">output_dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>Directory where files will be saved.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Show progress bar?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A sits tibble or a sits cube with new bands, produced
        according to the requested expression.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>sits_reduce()</code> allows valid R expression to compute new bands.
Use R syntax to pass an expression to this function.
Besides arithmetic operators, you can use virtually any R function
that can be applied to elements of a matrix.
The provided functions must operate at line level in order to perform
temporal reduction on a pixel.</p>
<p><code>sits_reduce()</code> Applies a function to each row of a matrix.
In this matrix, each row represents a pixel and each column
represents a single date. We provide some operations already
implemented in the package to perform the reduce operation.
See the list of available functions below:</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>t_sum()</code>, <code>t_std()</code>, <code>t_skewness()</code>,
 <code>t_kurtosis</code>, <code>t_mse</code> indexes generate values greater than
 the limit of a two-byte integer. Therefore, we save the images
 generated by these as Float-32 with no scale.</p>
    </div>
    <div class="section level2">
    <h2 id="summarizing-temporal-functions">Summarizing temporal functions<a class="anchor" aria-label="anchor" href="#summarizing-temporal-functions"></a></h2>


<ul><li><p><code>t_max()</code>: Returns the maximum value of the series.</p></li>
<li><p><code>t_min()</code>: Returns the minimum value of the series</p></li>
<li><p><code>t_mean()</code>: Returns the mean of the series.</p></li>
<li><p><code>t_median()</code>: Returns the median of the series.</p></li>
<li><p><code>t_std()</code>: Returns the standard deviation of the series.</p></li>
<li><p><code>t_skewness()</code>: Returns the skewness of the series.</p></li>
<li><p><code>t_kurtosis()</code>: Returns the kurtosis of the series.</p></li>
<li><p><code>t_amplitude()</code>: Returns the difference between the maximum and
 minimum values of the cycle. A small amplitude means a stable cycle.</p></li>
<li><p><code>t_fslope()</code>: Returns the maximum value of the first slope of
 the cycle. Indicates when the cycle presents an abrupt change in the
 curve. The slope between two values relates the speed of the growth or
 senescence phases</p></li>
<li><p><code>t_mse()</code>: Returns the average spectral energy density.
 The energy of the time series is distributed by frequency.</p></li>
<li><p><code>t_fqr()</code>: Returns the value of the first quartile of the
 series (0.25).</p></li>
<li><p><code>t_tqr()</code>: Returns the value of the third quartile of the
 series (0.75).</p></li>
<li><p><code>t_iqr()</code>: Returns the interquartile range
 (difference between the third and first quartiles).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Felipe Carvalho, <a href="mailto:felipe.carvalho@inpe.br">felipe.carvalho@inpe.br</a></p>
<p>Rolf Simoes, <a href="mailto:rolfsimoes@gmail.com">rolfsimoes@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="sits_run_examples.html">sits_run_examples</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># Reduce summarization function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">point2</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="sits_select.html">sits_select</a></span><span class="op">(</span><span class="va">point_mt_6bands</span>, <span class="st">"NDVI"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>        <span class="fu">sits_reduce</span><span class="op">(</span>NDVI_MEDIAN <span class="op">=</span> <span class="fu">t_median</span><span class="op">(</span><span class="va">NDVI</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Example of generation mean summarization from a cube</span></span></span>
<span class="r-in"><span>    <span class="co"># Create a data cube from local files</span></span></span>
<span class="r-in"><span>    <span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/raster/mod13q1"</span>, package <span class="op">=</span> <span class="st">"sits"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cube</span> <span class="op">&lt;-</span> <span class="fu"><a href="sits_cube.html">sits_cube</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        source <span class="op">=</span> <span class="st">"BDC"</span>,</span></span>
<span class="r-in"><span>        collection <span class="op">=</span> <span class="st">"MOD13Q1-6.1"</span>,</span></span>
<span class="r-in"><span>        data_dir <span class="op">=</span> <span class="va">data_dir</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Reduce NDVI band with mean function</span></span></span>
<span class="r-in"><span>    <span class="va">cube_mean</span> <span class="op">&lt;-</span> <span class="fu">sits_reduce</span><span class="op">(</span></span></span>
<span class="r-in"><span>        data <span class="op">=</span> <span class="va">cube</span>,</span></span>
<span class="r-in"><span>        NDVIMEAN <span class="op">=</span> <span class="fu">t_mean</span><span class="op">(</span><span class="va">NDVI</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rolf Simoes, Gilberto Camara, Felipe Souza, Felipe Carlos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

