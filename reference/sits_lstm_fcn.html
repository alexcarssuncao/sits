<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Train a Long Short Term Memory Fully Convolutional Network — sits_lstm_fcn • sits</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Serif-0.4.10/font.css" rel="stylesheet"><link href="../deps/IBM_Plex_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Train a Long Short Term Memory Fully Convolutional Network — sits_lstm_fcn"><meta name="description" content="Uses a branched neural network consisting of
 a lstm (long short term memory) branch and a three-layer fully
 convolutional branch (FCN)
 followed by concatenation to classify time series data.
This function is based on the paper by Fazle Karim, Somshubra Majumdar,
and Houshang Darabi. If you use this method, please cite the original
LSTM with FCN paper.
The torch version is based on the code made available by the titu1994.
The original python code is available at the website
https://github.com/titu1994/LSTM-FCN. This code is licensed as GPL-3."><meta property="og:description" content="Uses a branched neural network consisting of
 a lstm (long short term memory) branch and a three-layer fully
 convolutional branch (FCN)
 followed by concatenation to classify time series data.
This function is based on the paper by Fazle Karim, Somshubra Majumdar,
and Houshang Darabi. If you use this method, please cite the original
LSTM with FCN paper.
The torch version is based on the code made available by the titu1994.
The original python code is available at the website
https://github.com/titu1994/LSTM-FCN. This code is licensed as GPL-3."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sits</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.3-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://e-sensing.github.io/sitsbook/">Book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/e-sensing/sits/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Train a Long Short Term Memory Fully Convolutional Network</h1>
      <small class="dont-index">Source: <a href="https://github.com/e-sensing/sits/blob/HEAD/R/sits_lstm_fcn.R" class="external-link"><code>R/sits_lstm_fcn.R</code></a></small>
      <div class="d-none name"><code>sits_lstm_fcn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a branched neural network consisting of
 a lstm (long short term memory) branch and a three-layer fully
 convolutional branch (FCN)
 followed by concatenation to classify time series data.</p>
<p>This function is based on the paper by Fazle Karim, Somshubra Majumdar,
and Houshang Darabi. If you use this method, please cite the original
LSTM with FCN paper.</p>
<p>The torch version is based on the code made available by the titu1994.
The original python code is available at the website
<a href="https://github.com/titu1994/LSTM-FCN" class="external-link">https://github.com/titu1994/LSTM-FCN</a>. This code is licensed as GPL-3.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sits_lstm_fcn</span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples_validation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cnn_layers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">128</span>, <span class="fl">256</span>, <span class="fl">128</span><span class="op">)</span>,</span>
<span>  cnn_kernels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  cnn_dropout_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  lstm_width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  lstm_dropout <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  epochs <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">64</span>,</span>
<span>  validation_split <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="fu">torch</span><span class="fu">::</span><span class="va"><a href="https://torch.mlverse.org/docs/reference/optim_adamw.html" class="external-link">optim_adamw</a></span>,</span>
<span>  opt_hparams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lr <span class="op">=</span> <span class="fl">5e-04</span>, eps <span class="op">=</span> <span class="fl">1e-08</span>, weight_decay <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>,</span>
<span>  lr_decay_epochs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lr_decay_rate <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  patience <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  min_delta <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Time series with the training samples.</p></dd>


<dt id="arg-samples-validation">samples_validation<a class="anchor" aria-label="anchor" href="#arg-samples-validation"></a></dt>
<dd><p>Time series with the validation samples. if the
<code>samples_validation</code> parameter is provided,
the <code>validation_split</code> parameter is ignored.</p></dd>


<dt id="arg-cnn-layers">cnn_layers<a class="anchor" aria-label="anchor" href="#arg-cnn-layers"></a></dt>
<dd><p>Number of 1D convolutional filters per layer</p></dd>


<dt id="arg-cnn-kernels">cnn_kernels<a class="anchor" aria-label="anchor" href="#arg-cnn-kernels"></a></dt>
<dd><p>Size of the 1D convolutional kernels.</p></dd>


<dt id="arg-cnn-dropout-rates">cnn_dropout_rates<a class="anchor" aria-label="anchor" href="#arg-cnn-dropout-rates"></a></dt>
<dd><p>Dropout rates for 1D convolutional filters.</p></dd>


<dt id="arg-lstm-width">lstm_width<a class="anchor" aria-label="anchor" href="#arg-lstm-width"></a></dt>
<dd><p>Number of neuros in the lstm's hidden layer.</p></dd>


<dt id="arg-lstm-dropout">lstm_dropout<a class="anchor" aria-label="anchor" href="#arg-lstm-dropout"></a></dt>
<dd><p>Dropout rate of the lstm layer.</p></dd>


<dt id="arg-epochs">epochs<a class="anchor" aria-label="anchor" href="#arg-epochs"></a></dt>
<dd><p>Number of iterations to train the model.</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>Number of samples per gradient update.</p></dd>


<dt id="arg-validation-split">validation_split<a class="anchor" aria-label="anchor" href="#arg-validation-split"></a></dt>
<dd><p>Fraction of training data to be used for
validation.</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>Optimizer function to be used.</p></dd>


<dt id="arg-opt-hparams">opt_hparams<a class="anchor" aria-label="anchor" href="#arg-opt-hparams"></a></dt>
<dd><p>Hyperparameters for optimizer:
lr : Learning rate of the optimizer
eps: Term added to the denominator
     to improve numerical stability.
weight_decay:       L2 regularization</p></dd>


<dt id="arg-lr-decay-epochs">lr_decay_epochs<a class="anchor" aria-label="anchor" href="#arg-lr-decay-epochs"></a></dt>
<dd><p>Number of epochs to reduce learning rate.</p></dd>


<dt id="arg-lr-decay-rate">lr_decay_rate<a class="anchor" aria-label="anchor" href="#arg-lr-decay-rate"></a></dt>
<dd><p>Decay factor for reducing learning rate.</p></dd>


<dt id="arg-patience">patience<a class="anchor" aria-label="anchor" href="#arg-patience"></a></dt>
<dd><p>Number of epochs without improvements until
training stops.</p></dd>


<dt id="arg-min-delta">min_delta<a class="anchor" aria-label="anchor" href="#arg-min-delta"></a></dt>
<dd><p>Minimum improvement in loss function
to reset the patience counter.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Seed for random values.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Verbosity mode (TRUE/FALSE). Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A fitted model to be used for classification.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>F. Karim, S. Majumdar, H. Darabi and S. Chen,
"LSTM Fully Convolutional Networks for Time Series Classification,"
 in IEEE Access, vol. 6, pp. 1662-1669, 2018,
 doi: 10.1109/ACCESS.2017.2779939.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Alexandre Assuncao, <a href="mailto:alexcarssuncao@gmail.com">alexcarssuncao@gmail.com</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rolf Simoes, Gilberto Camara, Felipe Souza, Felipe Carlos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

